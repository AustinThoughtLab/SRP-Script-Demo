<!DOCTYPE html>
<html>
    <head>
        <title>My experiment</title>
		<script src="jspsych-6.0.5/jspsych.js"></script>
		<script src="jspsych-6.0.5/plugins/jspsych-html-keyboard-response.js"></script>
		<script src="jspsych-6.0.5/plugins/jspsych-audio-keyboard-response.js"></script>
		<link href="jspsych-6.0.5/css/jspsych.css" rel="stylesheet" type="text/css"></link>
    </head>
    <body></body>
	<script>
		
	//create timeline array//
	var timeline = [];
	
	//welcome message//	
	var welcome = {
		type: 'html-keyboard-response',
		stimulus: 'Welcome to the experiment! Press any key to begin.'
	};
	timeline.push(welcome);
	
	//description of what the subject is about to hear (habituation)//
	var habituation_instructions = {
		type: "html-keyboard-response",
    	stimulus: "<p>You are about to hear two types of tones, a short tone and a long tone.</p>" +
              "<p>After each tone, a screen will tell you what type of tone it was.</p>" +
              "<p>Press any key to begin.</p>"
	};
	timeline.push(habituation_instructions);
	
	//defines habituation, for some reason this only plays the long tone and never the 3ms one//
	var habituation_audio = [ 'sound/practice.mp3', 'sound/6ms.mp3'];
	
	var habituation_fixation = {
	    type: 'html-keyboard-response',
	    stimulus: '<div style="font-size:60px;">+</div>',
	    choices: jsPsych.NO_KEYS,
	    trial_duration: 1500,
	}
		
	var habituation = {
		type: 'audio-keyboard-response',
		stimulus: function() { return 'sound/practice.mp3', 'sound/6ms.mp3' },
		choices: jsPsych.NO_KEYS,
		trial_ends_after_audio: true,
		prompt: "This is a sound."
	}
		
	var habituation_procedure = {
		timeline: [habituation_fixation, habituation],
  	  	timeline_variables: habituation_audio,
		randomize_order: true,
		repetitions: 3
	}
	timeline.push(habituation_procedure);
	
  	//instructions on the actual task//
    var instructions = {
      	type: "html-keyboard-response",
      	stimulus: "<p>You are about to hear different tones.</p>" +
              "<p>Your job will be to say whether the tone you hear sounds more like the short tone or the long tone.</p>" +
              "<p>Press 'f' if you think the tone you hear sounds more like the short tone.</p>" +
              "<p>Press 'j' if you think the tone you hear sounds more like the long tone.</p>" +
              "<p>Press any key to begin.</p>"
    };
    timeline.push(instructions);
	
	//actual trial//
	
	var test_audio = [  	'sound/3.5ms.mp3',
							'sound/5.5ms.mp3'];
	
	var test_fixation = {
	    type: 'html-keyboard-response',
	    stimulus: '<div style="font-size:60px;">+</div>',
	    choices: jsPsych.NO_KEYS,
	    trial_duration: 3000,
	}
	//test//
	var test = {
	    type: 'audio-keyboard-response',
		stimulus: function() { return 'sound/3.5ms.mp3', 'sound/5.5ms.mp3' },
		choices: ['f', 'j'],
		response_ends_trial: false,
		trial_duration: null,
		prompt:
				"<p>Press 'f' if you think the tone you hear sounds more like the short tone.</p>" +
				"<p>Press 'j' if you think the tone you hear sounds more like the long tone.<p>"
		
	}

	var test_procedure = {
	    timeline: [test_fixation, test],
  	  	timeline_variables: test_audio,
	    randomize_order: true,
	    repetitions: 5
	}
	timeline.push(test_procedure);
	
	
	
	
  //end message//
    var ending = {
      	type: "html-keyboard-response",
      	stimulus: "<p>Thank you for participating in this game! You can go get your sticker and prize now!</p>"
    };
    timeline.push(ending);
	
	
	jsPsych.init({
		timeline: timeline,
		preload_audio: [habituation_audio, test_audio]
	})
	

	</script>	
</html>